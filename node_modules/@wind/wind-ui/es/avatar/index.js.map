{"version":3,"sources":["avatar/index.jsx"],"names":["__rest","s","e","t","p","Object","prototype","hasOwnProperty","call","indexOf","getOwnPropertySymbols","i","length","propertyIsEnumerable","React","classNames","Avatar","props","setScale","avatarChildren","avatarNode","childrenWidth","offsetWidth","nodeWidth","lastChildrenWidth","lastNodeWidth","setState","scale","handleImgLoadError","isImgExist","state","prevProps","prevState","children","_a","prefixCls","shape","size","src","icon","className","others","sizeCls","classString","childrenNode","childrenStyle","msTransform","WebkitTransform","transform","position","display","left","Math","round","span","node","Component","defaultProps"],"mappings":"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","sourcesContent":["var __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport React from 'react';\nimport classNames from 'classnames';\nexport default class Avatar extends React.Component {\n    constructor(props) {\n        super(props);\n        this.setScale = () => {\n            if (!this.avatarChildren || !this.avatarNode) {\n                return;\n            }\n            const childrenWidth = this.avatarChildren.offsetWidth; // offsetWidth avoid affecting be transform scale\n            const nodeWidth = this.avatarNode.offsetWidth;\n            // denominator is 0 is no meaning\n            if (childrenWidth === 0 ||\n                nodeWidth === 0 ||\n                (this.lastChildrenWidth === childrenWidth && this.lastNodeWidth === nodeWidth)) {\n                return;\n            }\n            this.lastChildrenWidth = childrenWidth;\n            this.lastNodeWidth = nodeWidth;\n            // add 4px gap for each side to get better performance\n            this.setState({\n                scale: nodeWidth - 8 < childrenWidth ? (nodeWidth - 8) / childrenWidth : 1,\n            });\n        };\n        this.handleImgLoadError = () => this.setState({ isImgExist: false });\n        this.state = {\n            scale: 1,\n            isImgExist: true,\n        };\n    }\n    componentDidMount() {\n        this.setScale();\n    }\n    componentDidUpdate(prevProps, prevState) {\n        if (prevProps.children !== this.props.children\n            || (prevState.scale !== this.state.scale && this.state.scale === 1)) {\n            this.setScale();\n        }\n    }\n    render() {\n        const _a = this.props, { prefixCls, shape, size, src, icon, className } = _a, others = __rest(_a, [\"prefixCls\", \"shape\", \"size\", \"src\", \"icon\", \"className\"]);\n        const sizeCls = classNames({\n            [`${prefixCls}-lg`]: size === 'large',\n            [`${prefixCls}-sm`]: size === 'small',\n        });\n        const classString = classNames(prefixCls, className, sizeCls, {\n            [`${prefixCls}-${shape}`]: shape,\n            [`${prefixCls}-image`]: src,\n            [`${prefixCls}-icon`]: icon,\n        });\n        let children = this.props.children;\n        if (src && this.state.isImgExist) {\n            children = (<img src={src} onError={this.handleImgLoadError}/>);\n        }\n        else if (icon) {\n            children = icon;\n        }\n        else {\n            const childrenNode = this.avatarChildren;\n            if (childrenNode || this.state.scale !== 1) {\n                const childrenStyle = {\n                    msTransform: `scale(${this.state.scale})`,\n                    WebkitTransform: `scale(${this.state.scale})`,\n                    transform: `scale(${this.state.scale})`,\n                    position: 'absolute',\n                    display: 'inline-block',\n                    left: `calc(50% - ${Math.round((childrenNode ? childrenNode.offsetWidth : 0) / 2)}px)`,\n                };\n                children = (<span className={`${prefixCls}-string`} ref={span => this.avatarChildren = span} style={childrenStyle}>\n            {children}\n          </span>);\n            }\n            else {\n                children = (<span className={`${prefixCls}-string`} ref={span => this.avatarChildren = span}>\n            {children}\n          </span>);\n            }\n        }\n        return (<span {...others} className={classString} ref={(node) => (this.avatarNode = node)}>\n        {children}\n      </span>);\n    }\n}\nAvatar.defaultProps = {\n    prefixCls: 'w-avatar',\n    shape: 'circle',\n    size: 'default',\n};\n"],"file":"index.js"}
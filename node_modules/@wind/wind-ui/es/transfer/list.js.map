{"version":3,"sources":["transfer/list.jsx"],"names":["React","classNames","PureRenderMixin","FixedSizeList","List","Checkbox","Search","Item","noop","isRenderResultPlainObject","result","isValidElement","Object","prototype","toString","call","TransferList","props","handleSelect","selectedItem","checkedKeys","some","key","handleFilter","e","target","value","handleClear","matchFilter","text","item","filter","filterOption","indexOf","renderItem","render","renderResult","isRenderResultPlain","renderedText","renderedEl","label","state","mounted","contentHeight","myRef","createRef","current","prefixCls","listContent","querySelector","setState","clientHeight","timer","window","setTimeout","clearTimeout","triggerScrollTimer","args","shouldComponentUpdate","apply","filteredDataSource","length","every","dataSource","titleText","lazy","body","footer","showSearch","style","searchPlaceholder","notFoundContent","selectAllText","footerDom","bodyDom","listCls","totalDataSource","showItems","forEach","trim","push","disabled","checked","onClick","search","listBodyCls","listBody","height","index","listFooter","checkStatus","getCheckStatus","checkedAll","checkAllCheckbox","handleSelectAll","Component","defaultProps"],"mappings":"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","sourcesContent":["import React from 'react';\nimport classNames from 'classnames';\n// import Animate from 'rc-animate';\nimport PureRenderMixin from 'rc-util/lib/PureRenderMixin';\nimport { FixedSizeList as List } from 'react-window';\nimport Checkbox from '../checkbox';\nimport Search from './search';\nimport Item from './item';\n// import triggerEvent from '../_util/triggerEvent';\nfunction noop() {\n}\nfunction isRenderResultPlainObject(result) {\n    return result && !React.isValidElement(result) &&\n        Object.prototype.toString.call(result) === '[object Object]';\n}\nexport default class TransferList extends React.Component {\n    constructor(props) {\n        super(props);\n        this.handleSelect = (selectedItem) => {\n            const { checkedKeys } = this.props;\n            const result = checkedKeys.some((key) => key === selectedItem.key);\n            this.props.handleSelect(selectedItem, !result);\n        };\n        this.handleFilter = (e) => {\n            this.props.handleFilter(e);\n            if (!e.target.value) {\n                return;\n            }\n            // Manually trigger scroll event for lazy search bug\n            // https://github.com/ant-design/ant-design/issues/5631\n            // this.triggerScrollTimer = window.setTimeout(() => {\n            //   const dom: any = findDOMNode(this);\n            //   if (dom) {\n            //     const listNode = dom.querySelectorAll('.w-transfer-list-content')[0];\n            //     if (listNode) {\n            //       triggerEvent(listNode, 'scroll');\n            //     }\n            //   }\n            // }, 0);\n        };\n        this.handleClear = () => {\n            this.props.handleClear();\n        };\n        this.matchFilter = (text, item) => {\n            const { filter, filterOption } = this.props;\n            if (filterOption) {\n                return filterOption(filter, item);\n            }\n            return text.indexOf(filter) >= 0;\n        };\n        this.renderItem = (item) => {\n            const { render = noop } = this.props;\n            const renderResult = render(item);\n            const isRenderResultPlain = isRenderResultPlainObject(renderResult);\n            return {\n                renderedText: isRenderResultPlain ? renderResult.value : renderResult,\n                renderedEl: isRenderResultPlain ? renderResult.label : renderResult,\n            };\n        };\n        this.state = {\n            mounted: false,\n            contentHeight: 0\n        };\n        this.myRef = React.createRef();\n    }\n    componentDidMount() {\n        const { current } = this.myRef;\n        const { prefixCls } = this.props;\n        if (current) {\n            const listContent = current.querySelector(`.${prefixCls}-content`);\n            if (listContent) {\n                this.setState({\n                    contentHeight: listContent.clientHeight\n                });\n            }\n        }\n        //w-transfer-list-content\n        this.timer = window.setTimeout(() => {\n            this.setState({\n                mounted: true,\n            });\n        }, 0);\n    }\n    componentWillUnmount() {\n        clearTimeout(this.timer);\n        clearTimeout(this.triggerScrollTimer);\n    }\n    shouldComponentUpdate(...args) {\n        return PureRenderMixin.shouldComponentUpdate.apply(this, args);\n    }\n    getCheckStatus(filteredDataSource) {\n        const { checkedKeys } = this.props;\n        if (checkedKeys.length === 0) {\n            return 'none';\n        }\n        else if (filteredDataSource.every(item => checkedKeys.indexOf(item.key) >= 0)) {\n            return 'all';\n        }\n        return 'part';\n    }\n    render() {\n        const { prefixCls, dataSource, titleText, checkedKeys, lazy, body = noop, footer = noop, showSearch, style, filter, searchPlaceholder, notFoundContent, selectAllText, } = this.props;\n        const { contentHeight } = this.state;\n        // Custom Layout\n        const footerDom = footer(Object.assign({}, this.props));\n        const bodyDom = body(Object.assign({}, this.props));\n        const listCls = classNames(prefixCls, {\n            [`${prefixCls}-with-footer`]: !!footerDom,\n        });\n        const filteredDataSource = [];\n        const totalDataSource = [];\n        const showItems = [];\n        dataSource.forEach((item) => {\n            const { renderedText, renderedEl } = this.renderItem(item);\n            if (filter && filter.trim() && !this.matchFilter(renderedText, item)) {\n                return null;\n            }\n            // all show items\n            totalDataSource.push(item);\n            if (!item.disabled) {\n                // response to checkAll items\n                filteredDataSource.push(item);\n            }\n            const checked = checkedKeys.indexOf(item.key) >= 0;\n            showItems.push({\n                key: item.key,\n                item,\n                renderedText,\n                renderedEl,\n                checked,\n                prefixCls,\n                onClick: this.handleSelect\n            });\n        });\n        // const unit = dataSource.length > 1 ? itemsUnit : itemUnit;\n        const search = showSearch ? (<div className={`${prefixCls}-body-search-wrapper`}>\n        <Search prefixCls={`${prefixCls}-search`} onChange={this.handleFilter} handleClear={this.handleClear} placeholder={searchPlaceholder} value={filter}/>\n      </div>) : null;\n        const listBodyCls = classNames(`${prefixCls}-body`, {\n            [`${prefixCls}-body-with-search`]: showSearch,\n            [`${prefixCls}-body-no-content`]: showItems.length === 0\n        });\n        const listBody = bodyDom || (<div className={listBodyCls}>\n        {search}\n        \n        <div className={`${prefixCls}-content`}>\n          {contentHeight > 0 ?\n            <List height={contentHeight} itemCount={showItems.length} itemSize={lazy && lazy.height}>\n              {({ index, style }) => {\n                const item = showItems[index];\n                return (<Item {...item} style={style}/>);\n                // <div key={showItems[index].key} style={style}>{showItems[index]}</div>\n            }}\n            </List> : null}\n        </div>\n        <div className={`${prefixCls}-body-not-found`}>\n          {notFoundContent}\n        </div>\n      </div>);\n        const listFooter = footerDom ? (<div className={`${prefixCls}-footer`}>\n        {footerDom}\n      </div>) : null;\n        const checkStatus = this.getCheckStatus(filteredDataSource);\n        const checkedAll = checkStatus === 'all';\n        const checkAllCheckbox = (<Checkbox ref=\"checkbox\" checked={checkedAll} indeterminate={checkStatus === 'part'} onChange={() => this.props.handleSelectAll(filteredDataSource, checkedAll)}>\n        <span className={`${prefixCls}-header-selected`}>\n          {selectAllText} (<span>\n            {`${checkedKeys.length}/` + totalDataSource.length}\n          </span>)\n        </span>\n      </Checkbox>);\n        return (<div className={listCls} style={style} ref={this.myRef}>\n        <div className={`${prefixCls}-header`}>\n          {checkAllCheckbox}\n          <span className={`${prefixCls}-header-title`}>\n            {titleText}\n          </span>\n        </div>\n        {listBody}\n        {listFooter}\n      </div>);\n    }\n}\nTransferList.defaultProps = {\n    dataSource: [],\n    titleText: '',\n    showSearch: false,\n    render: noop,\n    lazy: { height: 32 },\n};\n"],"file":"list.js"}
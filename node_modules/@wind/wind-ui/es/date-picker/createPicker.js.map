{"version":3,"sources":["date-picker/createPicker.jsx"],"names":["React","PropTypes","moment","MonthCalendar","RcDatePicker","classNames","omit","CloseCircleF","CalendarO","getLocaleCode","warning","popupAlign","points","overflow","adjustX","adjustY","offset","targetOffset","createPicker","TheCalendar","_a","props","renderFooter","prefixCls","renderExtraFooter","clearSelection","e","preventDefault","stopPropagation","handleChange","value","allowClear","setState","onChange","format","defaultValue","isMoment","Error","state","nextProps","locale","placeholder","lang","disabledTime","showTime","calendarClassName","pickerChangeHandler","calendarHandler","onSelect","showDateInput","calendar","disabledDate","timePicker","defaultPickerValue","onOk","showToday","monthCellContentRender","pickerStyle","width","style","clearIcon","disabled","input","inputValue","pickerInputClass","pickerValue","localeCode","context","className","pickerClass","popupStyle","Component","contextTypes","antLocale","object","defaultProps"],"mappings":"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","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport MonthCalendar from 'rc-calendar/lib/MonthCalendar';\nimport RcDatePicker from 'rc-calendar/lib/Picker';\nimport classNames from 'classnames';\nimport omit from 'omit.js';\nimport CloseCircleF from '@wind/icons/lib/icons/CloseCircleF';\nimport CalendarO from '@wind/icons/lib/icons/CalendarO';\nimport { getLocaleCode } from '../_util/getLocale';\nimport warning from '../_util/warning';\nexport const popupAlign = {\n    points: ['tl', 'bl'],\n    overflow: {\n        adjustX: 1,\n        adjustY: 1\n    },\n    offset: [0, 2],\n    targetOffset: [0, 0]\n};\nexport default function createPicker(TheCalendar) {\n    var _a;\n    return _a = class CalenderWrapper extends React.Component {\n            constructor(props) {\n                super(props);\n                this.renderFooter = (...args) => {\n                    const { prefixCls, renderExtraFooter } = this.props;\n                    return renderExtraFooter ? (<div className={`${prefixCls}-footer-extra`}>\n          {renderExtraFooter(...args)}\n        </div>) : null;\n                };\n                this.clearSelection = (e) => {\n                    e.preventDefault();\n                    e.stopPropagation();\n                    this.handleChange(null);\n                };\n                this.handleChange = (value) => {\n                    // console.log('DatePicker change,', value);\n                    const props = this.props;\n                    const { allowClear } = props;\n                    // 如果不允许清空但value为null，则不处理（防止input删除导致的清空）\n                    if (!allowClear && value == null) {\n                        return;\n                    }\n                    if (!('value' in props)) {\n                        this.setState({ value });\n                    }\n                    props.onChange(value, (value && value.format(props.format)) || '');\n                };\n                const value = props.value || props.defaultValue;\n                if (value && !moment.isMoment(value)) {\n                    throw new Error('The value/defaultValue of DatePicker or MonthPicker must be ' +\n                        'a moment object after `antd@2.0`, see: https://u.ant.design/date-picker-value');\n                }\n                this.state = {\n                    value,\n                };\n            }\n            componentWillReceiveProps(nextProps) {\n                if ('value' in nextProps) {\n                    this.setState({\n                        value: nextProps.value,\n                    });\n                }\n            }\n            // handleInputChange = (e) => {\n            //   const { value } = e.target;\n            //   this.handleChange(value);\n            // }\n            render() {\n                const { value } = this.state;\n                const props = omit(this.props, ['onChange']);\n                const { prefixCls, locale } = props;\n                const placeholder = ('placeholder' in props)\n                    ? props.placeholder : locale.lang.placeholder;\n                const disabledTime = props.showTime ? props.disabledTime : null;\n                const calendarClassName = classNames({\n                    [`${prefixCls}-time`]: props.showTime,\n                    [`${prefixCls}-month`]: MonthCalendar === TheCalendar,\n                });\n                let pickerChangeHandler = {};\n                let calendarHandler = {};\n                if (props.showTime) {\n                    calendarHandler = {\n                        // fix https://github.com/ant-design/ant-design/issues/1902\n                        onSelect: this.handleChange,\n                    };\n                }\n                else {\n                    pickerChangeHandler = {\n                        onChange: this.handleChange,\n                    };\n                }\n                const showDateInput = true; // 是否显示TheCalendar的DateInput\n                warning(!('onOK' in props), 'It should be `DatePicker[onOk]` or `MonthPicker[onOk]`, instead of `onOK`!');\n                const calendar = (<TheCalendar showDateInput={showDateInput} {...calendarHandler} disabledDate={props.disabledDate} disabledTime={disabledTime} locale={locale.lang} timePicker={props.timePicker} defaultValue={props.defaultPickerValue || moment()} dateInputPlaceholder={placeholder} prefixCls={prefixCls} className={calendarClassName} onOk={props.onOk} format={props.format} showToday={props.showToday} monthCellContentRender={props.monthCellContentRender} renderFooter={this.renderFooter}/>);\n                // default width for showTime\n                const pickerStyle = {};\n                if (props.showTime) {\n                    pickerStyle.width = (props.style && props.style.width) || 154;\n                }\n                const clearIcon = (!props.disabled && props.allowClear && value) ? (<CloseCircleF className={`${prefixCls}-picker-clear`} onClick={this.clearSelection}/>) : null;\n                const input = ({ value: inputValue }) => (<div>\n          <input disabled={props.disabled} readOnly \n                // onChange={this.handleInputChange} \n                value={(inputValue && inputValue.format(props.format)) || ''} placeholder={placeholder} className={props.pickerInputClass}/>\n          {clearIcon}\n          <span className={`${prefixCls}-picker-icon`}><CalendarO /></span>\n        </div>);\n                const pickerValue = value;\n                const localeCode = getLocaleCode(this.context);\n                if (pickerValue && localeCode) {\n                    pickerValue.locale(localeCode);\n                }\n                const style = Object.assign(Object.assign({}, props.style), pickerStyle);\n                return (<span className={classNames(props.className, props.pickerClass)} style={style}>\n          <RcDatePicker align={showDateInput ? null : popupAlign} {...props} {...pickerChangeHandler} calendar={calendar} value={pickerValue} prefixCls={`${prefixCls}-picker-container`} style={props.popupStyle}>\n            {input}\n          </RcDatePicker>\n        </span>);\n            }\n        },\n        _a.contextTypes = {\n            antLocale: PropTypes.object,\n        },\n        _a.defaultProps = {\n            prefixCls: 'w-calendar',\n            allowClear: true,\n            showToday: true,\n        },\n        _a;\n}\n"],"file":"createPicker.js"}
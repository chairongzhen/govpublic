{"version":3,"sources":["upload/UploadList.jsx"],"names":["previewFile","file","callback","reader","FileReader","onloadend","result","readAsDataURL","UploadList","arguments","handleClose","onRemove","props","handlePreview","e","onPreview","preventDefault","listType","items","forEach","document","window","File","originFileObj","thumbUrl","undefined","previewDataUrl","forceUpdate","prefixCls","showPreviewIcon","showRemoveIcon","locale","list","map","progress","icon","status","url","uploading","name","loadingProgress","progressAttr","percent","infoUploadingClass","preview","style","pointerEvents","opacity","previewIcon","removeIcon","removeFile","removeIconCross","actions","message","response","error","statusText","uploadError","iconAndPreview","uid","listClassNames","animationDirection","React","Component","defaultProps","strokeWidth","showInfo"],"mappings":"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","sourcesContent":["import React from 'react';\nimport Animate from 'rc-animate';\nimport LoadingO from '@wind/icons/lib/icons/LoadingO';\nimport PaperClipO from '@wind/icons/lib/icons/PaperClipO';\nimport PictureO from '@wind/icons/lib/icons/PictureO';\nimport EyeO from '@wind/icons/lib/icons/EyeO';\nimport DeleteO from '@wind/icons/lib/icons/DeleteO';\nimport CloseO from '@wind/icons/lib/icons/CloseO';\nimport Tooltip from '../tooltip';\nimport Progress from '../progress';\nimport classNames from 'classnames';\n// https://developer.mozilla.org/en-US/docs/Web/API/FileReader/readAsDataURL\nconst previewFile = (file, callback) => {\n    const reader = new FileReader();\n    reader.onloadend = () => callback(reader.result);\n    reader.readAsDataURL(file);\n};\nexport default class UploadList extends React.Component {\n    constructor() {\n        super(...arguments);\n        this.handleClose = (file) => {\n            const onRemove = this.props.onRemove;\n            if (onRemove) {\n                onRemove(file);\n            }\n        };\n        this.handlePreview = (file, e) => {\n            const { onPreview } = this.props;\n            if (!onPreview) {\n                return;\n            }\n            e.preventDefault();\n            return onPreview(file);\n        };\n    }\n    componentDidUpdate() {\n        if (this.props.listType !== 'picture' && this.props.listType !== 'picture-card') {\n            return;\n        }\n        (this.props.items || []).forEach(file => {\n            if (typeof document === 'undefined' ||\n                typeof window === 'undefined' ||\n                !window.FileReader || !window.File ||\n                !(file.originFileObj instanceof File) ||\n                file.thumbUrl !== undefined) {\n                return;\n            }\n            /*eslint-disable */\n            file.thumbUrl = '';\n            /*eslint-enable */\n            previewFile(file.originFileObj, (previewDataUrl) => {\n                /*eslint-disable */\n                file.thumbUrl = previewDataUrl;\n                /*eslint-enable */\n                this.forceUpdate();\n            });\n        });\n    }\n    render() {\n        const { prefixCls, items = [], listType, showPreviewIcon, showRemoveIcon, locale } = this.props;\n        const list = items.map(file => {\n            let progress;\n            let icon = file.status === 'uploading' ? <LoadingO /> : <PaperClipO />;\n            if (listType === 'picture' || listType === 'picture-card') {\n                if (file.status === 'uploading' || (!file.thumbUrl && !file.url)) {\n                    if (listType === 'picture-card') {\n                        icon = <div className={`${prefixCls}-list-item-uploading-text`}>{locale.uploading}</div>;\n                    }\n                    else {\n                        icon = <PictureO className={`${prefixCls}-list-item-thumbnail`}/>;\n                    }\n                }\n                else {\n                    icon = (<a className={`${prefixCls}-list-item-thumbnail`} onClick={e => this.handlePreview(file, e)} href={file.url || file.thumbUrl} target=\"_blank\" rel=\"noopener noreferrer\">\n              <img src={file.thumbUrl || file.url} alt={file.name}/>\n            </a>);\n                }\n            }\n            if (file.status === 'uploading') {\n                // show loading icon if upload progress listener is disabled\n                const loadingProgress = ('percent' in file) ? (<Progress type=\"line\" {...this.props.progressAttr} percent={file.percent}/>) : null;\n                progress = (<div className={`${prefixCls}-list-item-progress`} key=\"progress\">\n            {loadingProgress}\n          </div>);\n            }\n            const infoUploadingClass = classNames({\n                [`${prefixCls}-list-item`]: true,\n                [`${prefixCls}-list-item-${file.status}`]: true,\n            });\n            const preview = file.url ? (<a href={file.url} target=\"_blank\" rel=\"noopener noreferrer\" className={`${prefixCls}-list-item-name`} onClick={e => this.handlePreview(file, e)} title={file.name}>\n          {file.name}\n        </a>) : (<span className={`${prefixCls}-list-item-name`} onClick={e => this.handlePreview(file, e)} title={file.name}>\n            {file.name}\n          </span>);\n            const style = (file.url || file.thumbUrl) ? undefined : {\n                pointerEvents: 'none',\n                opacity: 0.5,\n            };\n            const previewIcon = showPreviewIcon ? (<a href={file.url || file.thumbUrl} target=\"_blank\" rel=\"noopener noreferrer\" style={style} onClick={e => this.handlePreview(file, e)} title={locale.previewFile}>\n          <EyeO />\n        </a>) : null;\n            const removeIcon = showRemoveIcon ? (<DeleteO title={locale.removeFile} onClick={() => this.handleClose(file)}/>) : null;\n            const removeIconCross = showRemoveIcon ? (<CloseO title={locale.removeFile} onClick={() => this.handleClose(file)}/>) : null;\n            const actions = (listType === 'picture-card' && file.status !== 'uploading')\n                ? <span className={`${prefixCls}-list-item-actions`}>{previewIcon}{removeIcon}</span>\n                : removeIconCross;\n            let message;\n            if (file.response && typeof file.response === 'string') {\n                message = file.response;\n            }\n            else {\n                message = (file.error && file.error.statusText) || locale.uploadError;\n            }\n            const iconAndPreview = (file.status === 'error')\n                ? <Tooltip title={message}>{icon}{preview}</Tooltip>\n                : <span>{icon}{preview}</span>;\n            return (<div className={infoUploadingClass} key={file.uid}>\n          <div className={`${prefixCls}-list-item-info`}>\n            {iconAndPreview}\n          </div>\n          {actions}\n          <Animate transitionName=\"fade\" component=\"\">\n            {progress}\n          </Animate>\n        </div>);\n        });\n        const listClassNames = classNames({\n            [`${prefixCls}-list`]: true,\n            [`${prefixCls}-list-${listType}`]: true,\n        });\n        const animationDirection = listType === 'picture-card' ? 'animate-inline' : 'animate';\n        return (<Animate transitionName={`${prefixCls}-${animationDirection}`} component=\"div\" className={listClassNames}>\n        {list}\n      </Animate>);\n    }\n}\nUploadList.defaultProps = {\n    listType: 'text',\n    progressAttr: {\n        strokeWidth: 2,\n        showInfo: false,\n    },\n    prefixCls: 'w-upload',\n    showRemoveIcon: true,\n    showPreviewIcon: true,\n};\n"],"file":"UploadList.js"}